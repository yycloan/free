<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Loan Origination Fee - YYC Personal Finance</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #d61313;
            --secondary: #1C75BC;
            --dark: #333;
            --gray: #6c757d;
            --page-bg: #f9f9f9;
            --doc-bg: #ffffff;
            --warning-bg: #fffbe6;
            --warning-border: #ffe58f;
            --warning-text: #d66b0a;
        }

        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        body {
            background-color: var(--page-bg);
            font-family: 'Roboto', sans-serif;
            color: var(--dark);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        p {
            margin-top: 0;
            margin-bottom: 1.1rem;
        }

        .toolbar {
            position: fixed;
            top: 15px;
            right: 20px;
            z-index: 1001;
        }

        .toolbar-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.25);
            transition: all 0.3s ease;
        }
        
        .toolbar-btn:hover {
            background-color: #b00f0f;
            transform: translateY(-2px);
        }

        .document-container {
            max-width: 850px;
            margin: 20px auto;
        }
        
        .page {
            background: var(--doc-bg);
            border: 1px solid #e0e0e0;
            padding: 40px 50px;
            position: relative;
            min-height: 1120px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .doc-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-bottom: 25px;
        }

        .doc-header .logo h1 { color: var(--primary); font-size: 2.2rem; margin: 0; }
        .doc-header .logo h2 { color: var(--secondary); font-size: 1.1rem; margin: 0; font-weight: 500; }
        .doc-header .header-info { text-align: right; font-size: 0.9rem; color: var(--gray); }

        .doc-footer {
            position: absolute;
            bottom: 40px;
            left: 50px;
            right: 50px;
            text-align: center;
            font-size: 0.85rem;
            color: var(--gray);
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }

        h3 {
            font-size: 1.4rem;
            color: var(--primary);
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-top: 25px;
            margin-bottom: 20px;
        }
        
        .summary-box {
            background: #f0f8ff;
            border-left: 5px solid var(--secondary);
            padding: 20px;
            margin: 25px 0;
            border-radius: 5px;
        }

        .summary-box ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .summary-box ul li {
            padding: 8px 0;
            display: flex;
            justify-content: space-between;
            font-size: 1.1rem;
            border-bottom: 1px solid #e0e6eb;
        }
        .summary-box ul li:last-child { border-bottom: none; }
        
        .final-payment-notice {
            background: var(--warning-bg);
            border: 1px solid var(--warning-border);
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
        }
        
        .final-payment-notice h4 {
             margin-top: 0;
             color: var(--warning-text);
             font-size: 1.25rem;
        }
        .final-payment-notice p {
            margin-bottom: 0;
            color: #5b491a;
        }
        
        .signature-section {
            margin-top: 40px;
        }
        
        .signature-image {
            display: block;
            max-width: 180px;
            margin-bottom: 5px;
        }
        
        @media print {
            body { padding: 0; background: #fff; }
            .toolbar, .page { box-shadow: none; border: none; margin: 0; }
            .document-container { width: 100%; }
            .page { min-height: 0; }
        }
    </style>
</head>
<body>

<div class="toolbar">
    <button class="toolbar-btn" id="downloadPdfBtn"><i class="fas fa-download"></i> Download PDF</button>
</div>

<div class="document-container" id="originationFeeDocument">
    <div class="page" id="page1">
        <div class="doc-header">
            <div class="logo"><h1>YYC</h1><h2>PERSONAL FINANCE</h2></div>
            <div class="header-info">
                <strong>Document:</strong> Loan Origination Fee<br>
                <strong>Date:</strong> <span id="current-date"></span><br>
                <strong>Ref ID:</strong> OF-202408-<span id="application-id"></span>
            </div>
        </div>

        <h3>Subject: Loan Origination Fee for Loan Application</h3>

        <p>Dear <strong id="user-name-salutation"></strong>,</p>

        <p>We are pleased to confirm that your loan application for an amount of <strong id="loan-amount-text"></strong> has been approved. As part of the loan agreement, there is a loan origination fee that is required in order to complete the processing and formalization of your loan. This fee covers the legal and administrative costs of securing and preparing the necessary documentation for your loan.</p>
        
        <div class="summary-box">
             <h4>Loan Origination Fee Breakdown:</h4>
             <ul>
                <li><span>Fee Percentage:</span> <strong id="fee-percentage"></strong></li>
                <li><span>Fee Amount:</span> <strong id="fee-amount" style="color: var(--primary); font-weight: 700;"></strong></li>
             </ul>
             <small style="display: block; margin-top: 15px; color: var(--gray);">This fee must be paid upfront and cannot be deducted from the loan amount. The fee is a legal cost incurred as part of finalizing the loan agreement.</small>
        </div>

        <div class="final-payment-notice">
            <h4><i class="fas fa-check-circle"></i> Final Payment Guarantee</h4>
            <p>Please note: <strong>This is the final payment required</strong> before the loan is fully processed and disbursed to you. No further fees or charges will be incurred beyond this payment. We guarantee that once this payment is received, all other administrative and legal costs will be settled, and the loan disbursement will proceed without delay.</p>
        </div>

        <p>To proceed, kindly arrange the payment of <strong id="fee-amount-2"></strong> at your earliest convenience. Payment instructions will follow in a separate communication.</p>
        
        <p>Please be advised that failure to make this payment could delay the loan disbursement. Once this payment is processed, your loan will be fully finalized, and we will proceed with the agreed terms.</p>

        <p>If you have any questions or require clarification, please feel free to contact us at your convenience. We appreciate your prompt attention to this matter and look forward to assisting you with the final steps of your loan.</p>
        
        <div class="signature-section">
            <p style="margin-bottom: 0;">Sincerely,</p>
            <img src="image/211935-1qeWBB1398605222.jpg" alt="Digital Signature" class="signature-image">
            <p style="margin-top: 0;">
                <strong>YYC Cash Loan</strong><br>
                NCRCP15906
            </p>
        </div>

        <div class="doc-footer">YYC Personal Finance | NCRCP15906 | Confidential Document</div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // --- Configuration: All client data is set here ---
        const clientData = {
            name: "Sarel Van Aswegen",
            idNumber: "9010105045082",
            loanAmount: 1000000,
            originationFeePercentage: 0.003, // 0.3%
            originationFeeAmount: 3000
        };

        const formatCurrency = (num) => `R${num.toLocaleString('en-ZA', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;

        // --- Main function to populate the document ---
        function populateDocument() {
            const appId = clientData.idNumber.slice(-4);
            const today = new Date().toLocaleDateString("en-ZA", { year: 'numeric', month: 'long', day: 'numeric' });
            
            // Dates and IDs
            document.getElementById("current-date").textContent = today;
            document.getElementById("application-id").textContent = appId;

            // Salutation
            document.getElementById("user-name-salutation").textContent = `Mr. ${clientData.name.split(' ').pop()}`;
            
            // Amounts
            const formattedLoanAmount = formatCurrency(clientData.loanAmount);
            const formattedFeeAmount = formatCurrency(clientData.originationFeeAmount);
            
            document.getElementById("loan-amount-text").textContent = formattedLoanAmount;
            document.getElementById("fee-percentage").textContent = `${(clientData.originationFeePercentage * 100).toFixed(1)}% of the loan amount`;
            document.getElementById("fee-amount").textContent = formattedFeeAmount;
            document.getElementById("fee-amount-2").textContent = formattedFeeAmount;
        }

        populateDocument();

        // --- PDF Download Logic ---
        document.getElementById('downloadPdfBtn').addEventListener('click', function () {
            const element = document.getElementById('originationFeeDocument');
            const opt = {
                margin:       [0, 0, 0, 0],
                filename:     `YYC_Origination_Fee_${clientData.name.replace(' ', '_')}.pdf`,
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true },
                jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        });
    });
</script>

</body>
</html>
